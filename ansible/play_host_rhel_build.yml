---
- name: Configurer le serveur web Nginx
  hosts: all
  become: yes
  tasks:

    - name: Installation de nginx via dnf en désactivant le dépôt specifique
      ansible.builtin.dnf:
        name: nginx
        state: present

    - name: Création du dossier
      ansible.builtin.file:
        path: /var/www/html
        state: directory # S'assure que c'est un répertoire
        owner: nginx     # Définit le propriétaire (souvent 'nginx' ou 'apache')
        group: nginx
        mode: '0755'

    - name: Créer la page d'accueil personnalisée
      copy:
        content: |
          <!DOCTYPE html>
          <html lang="fr">
          <head>
            <title>Bienvenue !</title>
            <meta charset="UTF-8">
          </head>
          <body>
            <h1>Bienvenue sur mon application</h1>
          </body>
          </html>
        dest: /var/www/html/index.html
        owner: www-data
        group: www-data
        mode: '0755'

    - name: S'assurer que le service Nginx est démarré et activé au boot
      service:
        name: nginx
        state: started
        enabled: yes
